{
  "slug": "analyze-organization-hierarchy",
  "problem_title": "Analyze Organization Hierarchy",
  "number": 3482,
  "acceptance": 0.759,
  "difficulty": "Hard",
  "question": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine their level in the organization. The CEO is at level 1, direct reports to the CEO are at level 2, and so on.\n\n2. **Subordinate Count**: For each employee, count the total number of subordinates under them, including indirect subordinates.\n\n3. **Manager Chain**: For each employee, list their chain of managers up to the CEO.\n\n**Example:**\n\nGiven the following employee table:\n\n| employee_id | employee_name | manager_id |\n|-------------|---------------|------------|\n| 1           | Alice         | NULL       |\n| 2           | Bob           | 1          |\n| 3           | Charlie       | 1          |\n| 4           | David         | 2          |\n| 5           | Eve           | 2          |\n| 6           | Frank         | 3          |\n\nYour solution should output:\n\n1. **Hierarchy Levels**:\n\n| employee_id | employee_name | level |\n|-------------|---------------|-------|\n| 1           | Alice         | 1     |\n| 2           | Bob           | 2     |\n| 3           | Charlie       | 2     |\n| 4           | David         | 3     |\n| 5           | Eve           | 3     |\n| 6           | Frank         | 3     |\n\n2. **Subordinate Count**:\n\n| employee_id | employee_name | subordinate_count |\n|-------------|---------------|-------------------|\n| 1           | Alice         | 5                 |\n| 2           | Bob           | 2                 |\n| 3           | Charlie       | 1                 |\n| 4           | David         | 0                 |\n| 5           | Eve           | 0                 |\n| 6           | Frank         | 0                 |\n\n3. **Manager Chain**:\n\n| employee_id | employee_name | manager_chain     |\n|-------------|---------------|-------------------|\n| 1           | Alice         | NULL              |\n| 2           | Bob           | Alice             |\n| 3           | Charlie       | Alice             |\n| 4           | David         | Bob > Alice       |\n| 5           | Eve           | Bob > Alice       |\n| 6           | Frank         | Charlie > Alice   |\n\n**Constraints:**\n\n- The number of employees will not exceed 10^4.\n- Each employee will have a unique `employee_id`.\n- The `manager_id` for the CEO is `NULL`.",
  "post_href": "https://leetcode.com/problems/analyze-organization-hierarchy/discuss/3482/Hard-Python-Solution",
  "python_solutions": "class Solution:\n    def analyzeHierarchy(self, employees: List[List[int]]) -> Tuple[List[List[int]], List[List[int]], List[List[int]]]:\n        from collections import defaultdict, deque\n        # Build the tree and initialize data structures\n        tree = defaultdict(list)\n        employee_info = {}\n        for emp_id, emp_name, mgr_id in employees:\n            employee_info[emp_id] = {'name': emp_name, 'manager': mgr_id, 'level': 0, 'subordinates': 0, 'manager_chain': []}\n            if mgr_id is not None:\n                tree[mgr_id].append(emp_id)\n        # Find the CEO (root of the tree)\n        ceo = next(emp_id for emp_id, info in employee_info.items() if info['manager'] is None)\n        # BFS to determine levels and manager chains\n        queue = deque([(ceo, 1, [])])\n        while queue:\n            emp_id, level, chain = queue.popleft()\n            employee_info[emp_id]['level'] = level\n            employee_info[emp_id]['manager_chain'] = chain\n            for sub_id in tree[emp_id]:\n                queue.append((sub_id, level + 1, chain + [employee_info[emp_id]['name']]))\n        # DFS to count subordinates\n        def count_subordinates(emp_id):\n            count = 0\n            for sub_id in tree[emp_id]:\n                count += 1 + count_subordinates(sub_id)\n            employee_info[emp_id]['subordinates'] = count\n            return count\n        count_subordinates(ceo)\n        # Prepare results\n        hierarchy_levels = []\n        subordinate_counts = []\n        manager_chains = []\n        for emp_id, info in employee_info.items():\n            hierarchy_levels.append([emp_id, info['name'], info['level']])\n            subordinate_counts.append([emp_id, info['name'], info['subordinates']])\n            manager_chains.append([emp_id, info['name'], ' > '.join(reversed(info['manager_chain'])) or 'NULL'])\n        return hierarchy_levels, subordinate_counts, manager_chains",
  "post_title": "Hard Python Solution",
  "user": "leetcode_user",
  "upvotes": 40,
  "views": 1800,
  "augmented_questions": {
    "keyboard": {
      "0.0": "Write a solution to analyze the organizational hierarchy and answer the following: 1. * * Hierarchy Levels * *: For each employee, determine their level in the organization. The CEO is at level 1, direct reports to the CEO are at level 2, and so on. 2. * * Subordinate Count * *: For each employee, count the total number of subordinates under them, including indirect subordinates. 3. * * Manager Chain * *: For each employee, list their chain of managers up to the CEO.",
      "0.1": "Wrihe a solution to Snalyze the organizational hierarchy and answer the following: 1. * * Hierarchy Levels * *: For each emp.oyee, determine their lwvel in the otgsnization. The CEO is at level 1, direct feports to the CEO are at level 2, and so on. 2. * * Subordinate Count * *: For each employee, count the total number of subordinates under them, includinN indirect subordinates. 3. * * Manager dhain * *: For exch employee, lost their chain of manavers up to the CEO.",
      "0.2": "WritR a soluYi8n to anaOTze the organizational hierarchy and xnZwer the follp1ing: 1. * * H7erarcyy Levels * *: For each 3mplpyee, determjnw fheir level in the o4ganjXation. The CEO is at legel 1, direct reports to the CEO are at level 2, and so on. 2. * * Subordinate Count * *: For eQch smploySe, count the total nImNer of subordinates unfer tnem, iHcluSing indirect subordinates. 3. * * Manager Chain * *: For eSch employee, lis% their chWin of mwnQgers up to the CEO.",
      "0.3": "qr8te a coourion to abalUzf the oTgamixQtionxl hisEarchh and abswe# the f*l:owinv: 1. * * HierQ%vhy Lebela * *: For escy emolkye#, determine Hh4ir lsvwl in the oegaMisati(n. The CEO is at <svel 1, direct reports to the CEO are at lebeI 2, and so on. 2. * * S6borEOnWte CoumF * *: For eZSh employee, ckun% the total number of suV*rdina$eQ under thRN, including iBdirev^ subiFd8nstes. 3. * * MAnzRer fTain * *: For each eNploydD, ,kst tBsir chziJ of mQnqgets up to the CEO.",
      "0.4": "Wt&te a qplut9oH to aHSlySe the krgZgizztipHal hie5arvut and qhswe# the folIo!OHg: 1. * * H7era3Vgy LFv#lC * *: For 3Wch 3mpo(yeF, detDE,inD thWig Pevwl in the 8egajiAatioB. The CEO is at lrvFl 1, d9r4St T2poGts to the CEO are at lefe/ 2, and so on. 2. * * Aun8rdLnatW vounr * *: For eaxu emO;pyeD, dohnt the to^a? numNwG of suNordihWyss 6nded $Jem, lnSl&diny inXirrd% xKbprwina^es. 3. * * Manxgfg Cta(n * *: For eZDh ejpliyss, kUst thS7r XhaOn of mWHaVerE up to the CEO.",
      "0.5": "Ddkte a s*:7t&on to aMakhzf the PrbanisatOLjXl NKerW#dhy and xJswef the f8Olp#jng: 1. * * nie5stcny LevSPE * *: For 4acb DHplIhee, deRerJ8Jr ^hri3 o2gel in the odrAnuzstUon. The CEO is at Ief3l 1, di5@Vt rwooGtZ to the CEO are at Oevsi 2, and so on. 2. * * SibI4diMWre CLuh6 * *: For dacy @mpl9y$S, fo6Mt the go4ak nHHbe# of subK%Xihxt@s HnSe$ tUFm, (nFluduHN iJR8r2ct ZubLTdunW$es. 3. * * nsjaFer StaUn * *: For @acj eNplo52r, l(zt tNw(r dmaih of mahxn3rs up to the CEO.",
      "0.6": "W3KRe a so.u^*Ig to abaOuX$ the *#NanizQh*(BSl jieDQrXMh and Xjsw$F the fllposLHv: 1. * * MJe#aedh5 irve.Z * *: For 3WcG Dm9/oGe2, fDre$<iGe thR8e >eGe; in the oeraGOSa^i9b. The CEO is at lrDeK 1, dlDrSt DwO0rGs to the CEO are at :eCe; 2, and so on. 2. * * e TboFdKHAt# xoKbt * *: For FaxT 4<pIKyeR, X*un$ the FoFxl gumf4g of wHGIrfiHARes Knd$F 6yDm, inFO TdlhT OndiE3V4 s8Horwkba%wZ. 3. * * hShaHrr CUsih * *: For eWXu 3<Lkpyee, pls4 rJe8r cTXiJ of msnSBeFq up to the CEO.",
      "0.7": "Dr7G# a ZklH5o)n to QJXlHz3 the odgZjiXShiPhx? uLf#aEcY6 and aHDEf$ the ckkKlslng: 1. * * gKwra4vjH ;Wv$>a * *: For RqcJ @jpl*uR@, sw4d$h8ne 4jr*r ?rv$< in the iEvwnKzS%iLB. The CEO is at I4vwI 1, RlgeDf #do9tts to the CEO are at >@bep 2, and so on. 2. * * ZuV84WUgahe di8mt * *: For fWsh sh(lohDR, SLinR the YP5a: g TmND4 of sjf85vjna%rd 7Bre3 tb3j, iBSP^E7Jg uhdJ$$st CjnPrdjnW6RD. 3. * * <xnZheD vYAjn * *: For exft WJpll6ww, kks5 FTF7r FjXiB of mzhah@Tc up to the CEO.",
      "0.8": "qdiYr a X9Pu%&PM to xbqlGA# the *enxG8aSY(onsO ui3TXddMJ and qGs223 the BI>PL!*hg: 1. * * mOFtaEFj^ OWvfPQ * *: For Rwvt DJl?ogf#, R45e#HlM4 tjfJF ,4vS, in the 9TRXmLzafk0j. The CEO is at KdGep 1, Wi4sX^ %e0KE5z to the CEO are at P4be> 2, and so on. 2. * * SufKEw(gX%d CKjmH * *: For $Qvj Fh(.k%ew, SIuMH the %9fzl nkJVf4 of Q tG0exibaHFX ibSWr 6jsh, KGDlivuhh unVUgwD% d&b8gekbZFeq. 3. * * JWhaTRE sJs(n * *: For SwDJ 3<op8hRe, /jX4 4hS&4 fTWiB of hSnqh@4q up to the CEO.",
      "0.9": "2e8$F a Qlo8f((m to QMQi7as the *rhZhJAXyoLgsi mU@DSfxjH and Abx!Wf the D*??kd&GH: 1. * * m8RfZedu^ /dGW<E * *: For #WDM $Kl;p&D#, w4FF4,8m$ hbdJF ,4C4, in the iensjUXQyoog. The CEO is at OFGwP 1, x8e4x$ T@(0T5E to the CEO are at oscd. 2, and so on. 2. * * Q7NPdv9jaHD F(JH5 * *: For DwVY wN0KITrd, sliBg the 69RA: m Tjvd% of CHNkevjba6Fw IHsDt %g4j, &Jv<7x&By LHR7%#sF d tnoDE9BwfFX. 3. * * Jwbzt3E fBS(m * *: For rsXY F,9;pT@2, ?KDY $gdj4 XGZ7j of KWGSYFgE up to the CEO.",
      "1.0": "e#Uy2 a d0?8$JpB to sHzk^xD the *eRQBlAZ5OIGq. uu3DWdDYj and XBxA25 the c8?KpdKJf: 1. * * UKf%X5Vn6 oFG4;z * *: For wAVj DnopIH2@, e3rftkOhD yB4&3 kRD4O in the IGRAj8Ax4O)G. The CEO is at /wFS, 1, sLerVr Ds(PE4D to the CEO are at ;#DFi 2, and so on. 2. * * Z8hKDS7JQ^f vl7j$ * *: For wzsJ 2K(k95d@, SL*mg the H9GAP B*JfSe of e6H*3CkgZ4$Z JmrFg ^t@N, ojf/8r8mN lbwudWDh A^HLfsuMx^#A. 3. * * JWHWn4E Xuw&H * *: For 4wxY wj0o*72r, :9XY $J484 Xbsug of <qmxfwFa up to the CEO."
    },
    "synonym": {
      "0.0": "Compose a solvent to analyze the organizational pecking order and answer the pursual: 1. * * Hierarchy Degree * *: For each employee, specify their level in the constitution. The chief executive officer is at grade 1, verbatim reports to the CEO live at stratum ii, and thence on. ii. * * Subordinate Count * *: For each employee, count the full number of subordinate nether them, including indirect underling. trio. * * Manager Chain * *: For each employee, number their chain of managers upwardly to the chief operating officer.",
      "0.1": "Write a solution to analyze the organizational hierarchy and answer the following: 1. * * Hierarchy Grade * *: For each employee, check their level in the organization. The CEO is at level 1, direct reports to the CEO are at level 2, and so on. ii. * * Subordinate Count * *: For each employee, depend the full number of underling nether them, including indirect subordinates. 3. * * Manager Strand * *: For each employee, list their range of managers up to the chief operating officer.",
      "0.2": "Write a solution to analyze the organizational hierarchy and answer the following: 1. * * Hierarchy Levels * *: For each employee, settle their level in the system. The CEO be at level 1, unmediated write up to the CEO are at spirit level 2, and so on. two. * * Subordinate Count * *: For each employee, count the total number of subordinate word nether them, include collateral subordinates. 3. * * Manager Ernst boris chain * *: For each employee, list their chain of coach up to the CEO.",
      "0.3": "Drop a line a solution to analyze the organisational hierarchy and resolve the following: 1. * * Hierarchy Levels * *: For each employee, determine their spirit level in the organization. The CEO is at spirit level i, direct reports to the chief executive officer make up at grade ii, and thusly on. ii. * * Hyponym Enumeration * *: For each employee, count the total number of subordinates nether them, include indirect underling. tierce. * * Director Chain * *: For each employee, list their chemical chain of managers upward to the chief operating officer.",
      "0.4": "Compose a resolution to examine the organisational hierarchy and reply the following: single. * * Power structure Point * *: For each employee, regulate their storey in the organization. The CEO is at storey ane, unmediated reports to the CEO cost at point ii, and thus on. 2. * * Subordinate word Count * *: For each employee, bet the full numeral of subordinate nether them, including indirect subordinate word. three. * * Handler Range of mountains * *: For each employee, list their chemical chain of managers upward to the chief executive officer.",
      "0.5": "Drop a line a result to psychoanalyse the organisational pecking order and resolve the pursual: single. * * Power structure Degree * *: For each employee, square off their floor in the organisation. The chief executive officer be at story unity, direct report to the chief executive officer be at degree 2, and indeed on. deuce. * * Subordinate Numeration * *: For each employee, count the full act of subordinate nether them, including collateral subordinates. iii. * * Managing director Mountain range * *: For each employee, lean their strand of managing director upward to the chief operating officer.",
      "0.6": "Compose a answer to analyse the organisational power structure and serve the pursuit: one. * * Pecking order Level * *: For each employee, fix their tier in the brass. The chief operating officer represent at stratum ane, verbatim story to the chief operating officer be at floor deuce, and then on. two. * * Underling Reckoning * *: For each employee, calculate the full figure of subordinate nether them, admit collateral foot soldier. tierce. * * Director Range * *: For each employee, lean their ernst boris chain of handler upward to the chief operating officer.",
      "0.7": "Publish a resolution to canvas the organisational pecking order and suffice the followers: ace. * * Pecking order Spirit level * *: For each employee, find out their stratum in the organisation. The chief executive officer embody at grade ane, lineal report to the chief operating officer personify at grade deuce, and thus on. deuce. * * Subordinate word Enumeration * *: For each employee, calculate the entire telephone number of subordinate nether them, let in collateral subordinate word. terzetto. * * Director String * *: For each employee, lean their concatenation of handler upward to the chief executive officer.",
      "0.8": "Drop a line a answer to analyse the organisational pecking order and resolve the chase: i. * * Pecking order Spirit level * *: For each employee, mold their point in the organisation. The chief operating officer be at storey one, lineal account to the chief executive officer be at layer two, and thus on. two. * * Subordinate word Tally * *: For each employee, numerate the entire routine of subordinate nether them, include collateral subordinate. iii. * * Coach Concatenation * *: For each employee, heel their string of director upwards to the chief executive officer.",
      "0.9": "Indite a result to study the organisational power structure and resolve the pursual: i. * * Pecking order Degree * *: For each employee, make up one's mind their floor in the formation. The chief operating officer be at stage one, verbatim news report to the chief operating officer constitute at stratum ii, and therefore on. ii. * * Foot soldier Reckoning * *: For each employee, calculate the full turn of subsidiary nether them, let in collateral foot soldier. three. * * Managing director Concatenation * *: For each employee, number their chain of mountains of coach upwardly to the chief executive officer.",
      "1.0": "Publish a answer to analyse the organisational power structure and reply the pursual: one. * * Power structure Layer * *: For each employee, set their floor in the brass. The chief executive officer be at grade ace, verbatim account to the chief executive officer be at degree deuce, and thus on. deuce. * * Subsidiary Numeration * *: For each employee, consider the full routine of subordinate nether them, admit collateral subordinate word. ternion. * * Director Concatenation * *: For each employee, number their mountain chain of manager upward to the chief operating officer."
    },
    "random": {
      "0.0": "Write to organizational hierarchy and following: . * * Hierarchy Levels * *: For employee, determine in the. is at level, direct reports the CEO are at, on. 2. * * Subordinate Count * *: For each employee, count the total under, including indirect subordinates. 3. * * * *: For each employee, their of managers.",
      "0.1": "A solution to analyze the organizational hierarchy and answer the following: . * * Hierarchy Levels * *: For each employee, determine their level the organization. The CEO is at level 1, direct reports to the at 2, and so on. 2. * * Subordinate Count * *: For each, count the total of under them, including indirect subordinates. . * * Manager Chain * *: For each employee, list their chain of managers to the CEO.",
      "0.2": "A solution to analyze the organizational the following: 1. * * Hierarchy * *: For employee, determine their in organization. The is at level 1, reports to the at 2, so. 2. * * Subordinate * *: For each employee, the total number of under, including indirect. 3. * * Manager Chain * *: For each employee, list their chain of managers up the CEO.",
      "0.3": "A solution to organizational and answer the: 1. * * Hierarchy * *: For each employee, level in the organization. at, direct the 2, and on. 2. * * Subordinate Count * *: For employee, count the total number of subordinates, including. 3. * * Manager Chain * *: For, their chain of to the.",
      "0.4": "Write a analyze hierarchy answer: . * * Levels * *: , determine their level in. at, reports to the CEO are at level 2, so. . * * * *: employee, total of under, including indirect. . * * Chain * *: , managers up to the CEO.",
      "0.5": "Write solution analyze hierarchy: . * * Levels * *: , determine organization. The at 1, the CEO, on. . * * Subordinate * *: employee, count under them, . 3. * * Manager * *: employee, CEO.",
      "0.6": "A the organizational following: . * * * *: each employee, ., reports to at, .. * * * *: , number, .. * * * *: For, their managers.",
      "0.7": "A: . * * * *: ,. ,, .. * * * *: ,, .. * * * *: For,.",
      "0.8": "A: . * * * *: ,. ,, .. * * * *: ,, .. * * * *: ,.",
      "0.9": "A: . * * * *: ,. ,, .. * * * *: ,, .. * * * *: ,.",
      "1.0": "A: . * * * *: ,. ,, .. * * * *: ,, .. * * * *: ,."
    },
    "cut": {
      "0.0": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine their level in the organization. The CEO is at level 1, direct reports to the CEO are at level 2, and so on.\n\n2. **Subordinate Count**: For each employee, count the total number of subordinates under them, including indirect subordinates.\n\n3. **Manager Chain**: For each employee, list their chain of managers up to the CEO.",
      "0.1": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine their level in the organization. The CEO is at level 1, direct reports to the CEO are at level 2, and so on.\n\n2. **Subordinate Count**: For each employee, count the total number of subordinates under them, including indirect subordinates.\n\n3. **Manager Chain**: For each employe",
      "0.2": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine their level in the organization. The CEO is at level 1, direct reports to the CEO are at level 2, and so on.\n\n2. **Subordinate Count**: For each employee, count the total number of subordinates under them, including indirect subordi",
      "0.3": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine their level in the organization. The CEO is at level 1, direct reports to the CEO are at level 2, and so on.\n\n2. **Subordinate Count**: For each employee, count the total number of subo",
      "0.4": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine their level in the organization. The CEO is at level 1, direct reports to the CEO are at level 2, and so on.\n\n2. **Subordinate Count**: For",
      "0.5": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine their level in the organization. The CEO is at level 1, direct reports to the CEO are at leve",
      "0.6": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine their level in the organization. The CEO is at ",
      "0.7": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hierarchy Levels**: For each employee, determine t",
      "0.8": "Write a solution to analyze the organizational hierarchy and answer the following:\n\n1. **Hie",
      "0.9": "Write a solution to analyze the organizational",
      "1.0": ""
    }
  },
  "llm_responses": {
    "google": {
      "synonym": {
        "0.0": [
          "class Employee:\n    def __init__(self, employee_id, name, manager_id=None):\n        self.employee_id = employee_id\n        self.name = name\n        self.manager_id = manager_id\n        self.subordinates = []\n        self.hierarchy_level = 0\n        self.subordinate_count = 0\n        self.manager_chain_length = 0\n\ndef analyze_organization(employees):\n    \"\"\"\n    Analyzes the organizational pecking order and provides insights.\n\n    Args:\n        employees: A list of Employee objects representing the organization.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are dictionaries\n        containing hierarchy level, subordinate count, and manager chain length.\n    \"\"\"\n\n    employee_map = {emp.employee_id: emp for emp in employees}\n\n    # Build the organizational structure (tree)\n    ceo = None\n    for employee in employees:\n        if employee.manager_id:\n            manager = employee_map.get(employee.manager_id)\n            if manager:\n                manager.subordinates.append(employee)\n        else:\n            ceo = employee  # Assume only one CEO\n\n    if not ceo:\n        return {}  # Empty organization\n\n    # Calculate hierarchy levels using Depth-First Search (DFS)\n    def calculate_hierarchy_levels(employee, level):\n        employee.hierarchy_level = level\n        for subordinate in employee.subordinates:\n            calculate_hierarchy_levels(subordinate, level + 1)\n\n    calculate_hierarchy_levels(ceo, 1)\n\n    # Calculate subordinate counts using Depth-First Search (DFS)\n    def calculate_subordinate_counts(employee):\n        count = 0\n        for subordinate in employee.subordinates:\n            count += 1 + calculate_subordinate_counts(subordinate)\n        employee.subordinate_count = count\n        return count\n\n    calculate_subordinate_counts(ceo)\n\n    # Calculate manager chain lengths\n    def calculate_manager_chain_lengths(employee):\n        if employee.manager_id:\n            manager = employee_map.get(employee.manager_id)\n            if manager:\n                employee.manager_chain_length = manager.manager_chain_length + 1\n        else:\n            employee.manager_chain_length = 0  # CEO has no managers\n\n        for subordinate in employee.subordinates:\n            calculate_manager_chain_lengths(subordinate)\n\n    calculate_manager_chain_lengths(ceo)\n\n    # Prepare the results\n    results = {}\n    for employee in employees:\n        results[employee.employee_id] = {\n            \"Hierarchy Degree\": employee.hierarchy_level,\n            \"Subordinate Count\": employee.subordinate_count,\n            \"Manager Chain\": employee.manager_chain_length,\n        }\n\n    return results\n\n\nif __name__ == '__main__':\n    # Example Usage\n    employees = [\n        Employee(1, \"Alice\", None),  # CEO\n        Employee(2, \"Bob\", 1),\n        Employee(3, \"Charlie\", 1),\n        Employee(4, \"David\", 2),\n        Employee(5, \"Eve\", 2),\n        Employee(6, \"Frank\", 3),\n    ]\n\n    analysis_results = analyze_organization(employees)\n\n    for employee_id, data in analysis_results.items():\n        print(f\"Employee ID: {employee_id}\")\n        print(f\"  Hierarchy Degree: {data['Hierarchy Degree']}\")\n        print(f\"  Subordinate Count: {data['Subordinate Count']}\")\n        print(f\"  Manager Chain: {data['Manager Chain']}\")\n        print(\"-\" * 20)"
        ],
        "0.1": [
          "class Employee:\n    def __init__(self, employee_id, name, manager_id=None):\n        self.employee_id = employee_id\n        self.name = name\n        self.manager_id = manager_id\n        self.subordinates = []\n        self.hierarchy_grade = None\n        self.subordinate_count = 0\n        self.manager_chain = []\n\ndef analyze_organization(employees):\n    \"\"\"\n    Analyzes the organizational hierarchy to determine hierarchy grade,\n    subordinate count, and manager chain for each employee.\n\n    Args:\n        employees: A list of Employee objects representing the organization.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are dictionaries\n        containing 'hierarchy_grade', 'subordinate_count', and 'manager_chain'.\n    \"\"\"\n\n    employee_map = {emp.employee_id: emp for emp in employees}\n\n    # Build the hierarchy tree\n    ceo = None\n    for employee in employees:\n        if employee.manager_id is None:\n            ceo = employee\n        else:\n            manager = employee_map.get(employee.manager_id)\n            if manager:\n                manager.subordinates.append(employee)\n\n    if not ceo:\n        return {}  # Empty organization\n\n    # Calculate hierarchy grade (level)\n    def calculate_hierarchy_grade(employee, level=1):\n        employee.hierarchy_grade = level\n        for subordinate in employee.subordinates:\n            calculate_hierarchy_grade(subordinate, level + 1)\n\n    calculate_hierarchy_grade(ceo)\n\n    # Calculate subordinate count\n    def calculate_subordinate_count(employee):\n        count = 0\n        for subordinate in employee.subordinates:\n            count += 1 + calculate_subordinate_count(subordinate)\n        employee.subordinate_count = count\n        return count\n\n    calculate_subordinate_count(ceo)\n\n    # Calculate manager chain\n    def calculate_manager_chain(employee, chain=None):\n        if chain is None:\n            chain = []\n        if employee.manager_id:\n            manager = employee_map.get(employee.manager_id)\n            if manager:\n                chain.insert(0, manager.name)\n                calculate_manager_chain(manager, chain)\n        employee.manager_chain = chain\n\n    for employee in employees:\n        calculate_manager_chain(employee)\n\n    # Prepare the result\n    result = {}\n    for employee in employees:\n        result[employee.employee_id] = {\n            'hierarchy_grade': employee.hierarchy_grade,\n            'subordinate_count': employee.subordinate_count,\n            'manager_chain': employee.manager_chain\n        }\n\n    return result\n\nif __name__ == '__main__':\n    # Example Usage\n    employees = [\n        Employee(1, \"Alice\", None),\n        Employee(2, \"Bob\", 1),\n        Employee(3, \"Charlie\", 1),\n        Employee(4, \"David\", 2),\n        Employee(5, \"Eve\", 2),\n        Employee(6, \"Frank\", 3),\n        Employee(7, \"Grace\", 3),\n        Employee(8, \"Heidi\", 4)\n    ]\n\n    analysis_result = analyze_organization(employees)\n\n    for employee_id, data in analysis_result.items():\n        print(f\"Employee ID: {employee_id}\")\n        print(f\"  Hierarchy Grade: {data['hierarchy_grade']}\")\n        print(f\"  Subordinate Count: {data['subordinate_count']}\")\n        print(f\"  Manager Chain: {', '.join(data['manager_chain'])}\")\n        print(\"-\" * 20)"
        ],
        "0.2": [
          "class Employee:\n    def __init__(self, id, name, manager_id=None):\n        self.id = id\n        self.name = name\n        self.manager_id = manager_id\n        self.level = None\n        self.subordinate_count = 0\n        self.manager_chain = []\n\ndef analyze_hierarchy(employees_data):\n    \"\"\"\n    Analyzes the organizational hierarchy to determine hierarchy levels,\n    subordinate counts, and manager chains for each employee.\n\n    Args:\n        employees_data: A list of dictionaries, where each dictionary\n                        represents an employee with 'id', 'name', and\n                        'manager_id' keys.  'manager_id' can be None for the CEO.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are dictionaries\n        containing 'level', 'subordinate_count', and 'manager_chain' information.\n    \"\"\"\n\n    employees = {}\n    for data in employees_data:\n        employees[data['id']] = Employee(data['id'], data['name'], data['manager_id'])\n\n    ceo_id = None\n    for employee_id, employee in employees.items():\n        if employee.manager_id is None:\n            ceo_id = employee_id\n            break\n\n    if ceo_id is None:\n        return {}  # Handle case where no CEO is found\n\n    # Calculate Hierarchy Levels (BFS)\n    queue = [(ceo_id, 1)]\n    while queue:\n        employee_id, level = queue.pop(0)\n        employees[employee_id].level = level\n        for subordinate_id, subordinate in employees.items():\n            if subordinate.manager_id == employee_id:\n                queue.append((subordinate_id, level + 1))\n\n    # Calculate Subordinate Counts (DFS)\n    def calculate_subordinates(employee_id):\n        count = 0\n        for subordinate_id, subordinate in employees.items():\n            if subordinate.manager_id == employee_id:\n                count += 1 + calculate_subordinates(subordinate_id)\n        employees[employee_id].subordinate_count = count\n        return count\n\n    calculate_subordinates(ceo_id)\n\n    # Calculate Manager Chains\n    for employee_id, employee in employees.items():\n        current_employee_id = employee_id\n        chain = []\n        while employees[current_employee_id].manager_id is not None:\n            manager_id = employees[current_employee_id].manager_id\n            chain.insert(0, employees[manager_id].name)\n            current_employee_id = manager_id\n        employees[employee_id].manager_chain = chain\n\n    # Prepare the result\n    result = {}\n    for employee_id, employee in employees.items():\n        result[employee_id] = {\n            'level': employee.level,\n            'subordinate_count': employee.subordinate_count,\n            'manager_chain': employee.manager_chain\n        }\n\n    return result\n\nif __name__ == '__main__':\n    employees_data = [\n        {'id': 1, 'name': 'Alice', 'manager_id': None},\n        {'id': 2, 'name': 'Bob', 'manager_id': 1},\n        {'id': 3, 'name': 'Charlie', 'manager_id': 1},\n        {'id': 4, 'name': 'David', 'manager_id': 2},\n        {'id': 5, 'name': 'Eve', 'manager_id': 2},\n        {'id': 6, 'name': 'Frank', 'manager_id': 3}\n    ]\n\n    analysis_result = analyze_hierarchy(employees_data)\n\n    for employee_id, data in analysis_result.items():\n        print(f\"Employee ID: {employee_id}\")\n        print(f\"  Level: {data['level']}\")\n        print(f\"  Subordinate Count: {data['subordinate_count']}\")\n        print(f\"  Manager Chain: {data['manager_chain']}\")\n        print(\"-\" * 20)"
        ],
        "0.3": [
          "class Employee:\n    def __init__(self, employee_id, name, manager_id=None):\n        self.employee_id = employee_id\n        self.name = name\n        self.manager_id = manager_id\n        self.level = None\n        self.subordinate_count = 0\n        self.manager_chain = []\n\ndef analyze_hierarchy(employees):\n    \"\"\"\n    Analyzes the organizational hierarchy to determine hierarchy levels,\n    hyponym enumeration, and manager chains for each employee.\n\n    Args:\n        employees: A list of Employee objects representing the organization.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are dictionaries\n        containing the employee's level, subordinate count, and manager chain.\n    \"\"\"\n\n    employee_map = {emp.employee_id: emp for emp in employees}\n    ceo = next((emp for emp in employees if emp.manager_id is None), None)\n\n    if not ceo:\n        return {}  # Empty organization\n\n    results = {}\n\n    def calculate_level(employee, level=1):\n        employee.level = level\n        results[employee.employee_id] = {\n            \"level\": employee.level,\n            \"subordinate_count\": 0,\n            \"manager_chain\": []\n        }\n        for subordinate_id, subordinate in employee_map.items():\n            if subordinate.manager_id == employee.employee_id:\n                calculate_level(subordinate, level + 1)\n\n    calculate_level(ceo)\n\n    def calculate_manager_chain(employee):\n        chain = []\n        manager_id = employee.manager_id\n        while manager_id:\n            manager = employee_map.get(manager_id)\n            if manager:\n                chain.append(manager.name)\n                manager_id = manager.manager_id\n            else:\n                break\n        results[employee.employee_id][\"manager_chain\"] = chain\n\n    for employee in employees:\n        calculate_manager_chain(employee)\n\n    def calculate_subordinate_count(employee):\n        count = 0\n        for subordinate_id, subordinate in employee_map.items():\n            if subordinate.manager_id == employee.employee_id:\n                count += 1 + calculate_subordinate_count(subordinate)\n        results[employee.employee_id][\"subordinate_count\"] = count\n        return count\n\n    calculate_subordinate_count(ceo)\n\n    return results\n\nif __name__ == '__main__':\n    # Example Usage\n    ceo = Employee(1, \"Alice (CEO)\")\n    manager1 = Employee(2, \"Bob\", 1)\n    manager2 = Employee(3, \"Charlie\", 1)\n    employee1 = Employee(4, \"David\", 2)\n    employee2 = Employee(5, \"Eve\", 2)\n    employee3 = Employee(6, \"Frank\", 3)\n    employee4 = Employee(7, \"Grace\", 3)\n    employee5 = Employee(8, \"Heidi\", 4)\n\n    employees = [ceo, manager1, manager2, employee1, employee2, employee3, employee4, employee5]\n\n    analysis_results = analyze_hierarchy(employees)\n\n    for employee_id, data in analysis_results.items():\n        employee = next(emp for emp in employees if emp.employee_id == employee_id)\n        print(f\"Employee: {employee.name} (ID: {employee_id})\")\n        print(f\"  Level: {data['level']}\")\n        print(f\"  Subordinate Count: {data['subordinate_count']}\")\n        print(f\"  Manager Chain: {', '.join(data['manager_chain'])}\")\n        print(\"-\" * 30)"
        ],
        "0.4": [
          "class Employee:\n    def __init__(self, employee_id, name, manager_id=None):\n        self.employee_id = employee_id\n        self.name = name\n        self.manager_id = manager_id\n        self.subordinates = []\n\ndef build_org_chart(employees):\n    \"\"\"Builds an organizational chart from a list of employees.\"\"\"\n    employee_map = {emp.employee_id: emp for emp in employees}\n    ceo = None\n\n    for employee in employees:\n        if employee.manager_id:\n            manager = employee_map.get(employee.manager_id)\n            if manager:\n                manager.subordinates.append(employee)\n        else:\n            ceo = employee\n\n    return ceo, employee_map\n\ndef calculate_levels(ceo, employee_map):\n    \"\"\"Calculates the level of each employee in the organization.\"\"\"\n    levels = {}\n    def traverse(employee, level):\n        levels[employee.employee_id] = level\n        for subordinate in employee.subordinates:\n            traverse(subordinate, level + 1)\n\n    traverse(ceo, 1)\n    return levels\n\ndef calculate_subordinate_count(employee_map):\n    \"\"\"Calculates the total number of subordinates for each employee.\"\"\"\n    subordinate_counts = {}\n\n    def count_subordinates(employee):\n        count = 0\n        for subordinate in employee.subordinates:\n            count += 1 + count_subordinates(subordinate)\n        subordinate_counts[employee.employee_id] = count\n        return count\n\n    for employee in employee_map.values():\n        if employee.manager_id is None: # Only calculate from the top to avoid double counting\n            count_subordinates(employee)\n\n    return subordinate_counts\n\ndef calculate_manager_chain(ceo, employee_map):\n    \"\"\"Calculates the chain of managers for each employee up to the CEO.\"\"\"\n    manager_chains = {}\n\n    def find_managers(employee, chain):\n        manager_chains[employee.employee_id] = chain[:]\n        if employee.manager_id:\n            manager = employee_map[employee.manager_id]\n            chain.insert(0, manager.name)\n            find_managers(manager, chain)\n\n    for employee in employee_map.values():\n        find_managers(employee, [])\n\n    return manager_chains\n\ndef analyze_organization(employees):\n    \"\"\"Analyzes the organizational hierarchy and returns the requested information.\"\"\"\n    ceo, employee_map = build_org_chart(employees)\n\n    levels = calculate_levels(ceo, employee_map)\n    subordinate_counts = calculate_subordinate_count(employee_map)\n    manager_chains = calculate_manager_chain(ceo, employee_map)\n\n    results = {}\n    for employee in employees:\n        results[employee.employee_id] = {\n            \"name\": employee.name,\n            \"level\": levels[employee.employee_id],\n            \"subordinate_count\": subordinate_counts[employee.employee_id],\n            \"manager_chain\": manager_chains[employee.employee_id]\n        }\n\n    return results\n\nif __name__ == '__main__':\n    # Example Usage\n    employees = [\n        Employee(1, \"CEO\"),\n        Employee(2, \"Manager A\", 1),\n        Employee(3, \"Manager B\", 1),\n        Employee(4, \"Employee X\", 2),\n        Employee(5, \"Employee Y\", 2),\n        Employee(6, \"Employee Z\", 3),\n        Employee(7, \"Employee W\", 3),\n        Employee(8, \"Employee V\", 4)\n    ]\n\n    analysis_results = analyze_organization(employees)\n\n    for employee_id, data in analysis_results.items():\n        print(f\"Employee ID: {employee_id}, Name: {data['name']}\")\n        print(f\"  Level: {data['level']}\")\n        print(f\"  Subordinate Count: {data['subordinate_count']}\")\n        print(f\"  Manager Chain: {', '.join(data['manager_chain']) or 'None'}\")\n        print(\"-\" * 30)"
        ],
        "0.5": [
          "class Employee:\n    def __init__(self, employee_id, name, manager_id=None):\n        self.employee_id = employee_id\n        self.name = name\n        self.manager_id = manager_id\n        self.subordinates = []\n        self.level = None\n        self.subordinate_count = 0\n        self.manager_chain = []\n\ndef analyze_organization(employees):\n    \"\"\"\n    Analyzes the organizational pecking order of a company.\n\n    Args:\n        employees: A list of Employee objects representing the organization.\n\n    Returns:\n        A dictionary containing the analysis results, including:\n            - power_structure: A dictionary mapping employee ID to their level in the organization.\n            - subordinate_counts: A dictionary mapping employee ID to the number of subordinates.\n            - manager_chains: A dictionary mapping employee ID to their chain of managers up to the CEO.\n    \"\"\"\n\n    employee_dict = {emp.employee_id: emp for emp in employees}\n\n    # Find the CEO (employee with no manager)\n    ceo = next((emp for emp in employees if emp.manager_id is None), None)\n    if not ceo:\n        return {\"error\": \"No CEO found.\"}\n\n    # Build the organizational hierarchy\n    for emp in employees:\n        if emp.manager_id:\n            manager = employee_dict.get(emp.manager_id)\n            if manager:\n                manager.subordinates.append(emp)\n\n    # Calculate power structure (level)\n    def calculate_levels(employee, level=1):\n        employee.level = level\n        for subordinate in employee.subordinates:\n            calculate_levels(subordinate, level + 1)\n\n    calculate_levels(ceo)\n\n    # Calculate subordinate counts\n    def calculate_subordinate_counts(employee):\n        count = 0\n        for subordinate in employee.subordinates:\n            count += calculate_subordinate_counts(subordinate) + 1\n        employee.subordinate_count = count\n        return count\n\n    calculate_subordinate_counts(ceo)\n\n    # Calculate manager chains\n    def calculate_manager_chain(employee):\n        chain = []\n        current = employee\n        while current.manager_id:\n            manager = employee_dict.get(current.manager_id)\n            if manager:\n                chain.append(manager.employee_id)\n                current = manager\n            else:\n                break  # Handle cases where manager is not found\n        employee.manager_chain = chain\n\n    for emp in employees:\n        calculate_manager_chain(emp)\n\n    # Prepare the results\n    power_structure = {emp.employee_id: emp.level for emp in employees}\n    subordinate_counts = {emp.employee_id: emp.subordinate_count for emp in employees}\n    manager_chains = {emp.employee_id: emp.manager_chain for emp in employees}\n\n    return {\n        \"power_structure\": power_structure,\n        \"subordinate_counts\": subordinate_counts,\n        \"manager_chains\": manager_chains,\n    }\n\nif __name__ == '__main__':\n    # Example Usage\n    employees = [\n        Employee(1, \"Alice\", None),\n        Employee(2, \"Bob\", 1),\n        Employee(3, \"Charlie\", 1),\n        Employee(4, \"David\", 2),\n        Employee(5, \"Eve\", 2),\n        Employee(6, \"Frank\", 3),\n    ]\n\n    analysis_results = analyze_organization(employees)\n\n    if \"error\" in analysis_results:\n        print(f\"Error: {analysis_results['error']}\")\n    else:\n        print(\"Power Structure (Level):\", analysis_results[\"power_structure\"])\n        print(\"Subordinate Counts:\", analysis_results[\"subordinate_counts\"])\n        print(\"Manager Chains:\", analysis_results[\"manager_chains\"])"
        ],
        "0.6": [
          "class Employee:\n    def __init__(self, name, manager=None):\n        self.name = name\n        self.manager = manager\n        self.subordinates = []\n\n    def add_subordinate(self, employee):\n        self.subordinates.append(employee)\n\ndef analyze_organization(ceo):\n    \"\"\"\n    Analyzes the organizational power structure.\n\n    Args:\n        ceo: The root Employee object representing the CEO.\n\n    Returns:\n        A dictionary containing the analysis results, with keys:\n            'pecking_order': A dictionary mapping employee names to their tier.\n            'underling_count': A dictionary mapping employee names to their underling count.\n            'director_range': A dictionary mapping employee names to their chain of command.\n    \"\"\"\n\n    pecking_order = {}\n    underling_count = {}\n    director_range = {}\n\n    def calculate_pecking_order(employee, level):\n        pecking_order[employee.name] = level\n        for subordinate in employee.subordinates:\n            calculate_pecking_order(subordinate, level + 1)\n\n    def calculate_underling_count(employee):\n        count = 0\n        for subordinate in employee.subordinates:\n            count += 1 + calculate_underling_count(subordinate)\n        underling_count[employee.name] = count\n        return count\n\n    def calculate_director_range(employee):\n        chain = []\n        current = employee\n        while current is not None:\n            chain.insert(0, current.name)\n            current = current.manager\n        director_range[employee.name] = chain\n\n    calculate_pecking_order(ceo, 1)\n    calculate_underling_count(ceo)\n    \n    def traverse_and_calculate_range(employee):\n        calculate_director_range(employee)\n        for subordinate in employee.subordinates:\n            traverse_and_calculate_range(subordinate)\n\n    traverse_and_calculate_range(ceo)\n\n    return {\n        'pecking_order': pecking_order,\n        'underling_count': underling_count,\n        'director_range': director_range\n    }\n\nif __name__ == '__main__':\n    # Example Usage\n    ceo = Employee(\"CEO\")\n    coo = Employee(\"COO\", ceo)\n    cfo = Employee(\"CFO\", ceo)\n    cto = Employee(\"CTO\", ceo)\n\n    ceo.add_subordinate(coo)\n    ceo.add_subordinate(cfo)\n    ceo.add_subordinate(cto)\n\n    vp_sales = Employee(\"VP Sales\", coo)\n    vp_marketing = Employee(\"VP Marketing\", coo)\n    coo.add_subordinate(vp_sales)\n    coo.add_subordinate(vp_marketing)\n\n    director_engineering = Employee(\"Director Engineering\", cto)\n    cto.add_subordinate(director_engineering)\n\n    sales_rep1 = Employee(\"Sales Rep 1\", vp_sales)\n    sales_rep2 = Employee(\"Sales Rep 2\", vp_sales)\n    vp_sales.add_subordinate(sales_rep1)\n    vp_sales.add_subordinate(sales_rep2)\n\n    software_engineer1 = Employee(\"Software Engineer 1\", director_engineering)\n    software_engineer2 = Employee(\"Software Engineer 2\", director_engineering)\n    director_engineering.add_subordinate(software_engineer1)\n    director_engineering.add_subordinate(software_engineer2)\n\n    analysis_results = analyze_organization(ceo)\n\n    print(\"Pecking Order:\", analysis_results['pecking_order'])\n    print(\"Underling Count:\", analysis_results['underling_count'])\n    print(\"Director Range:\", analysis_results['director_range'])"
        ],
        "0.7": [
          "class Employee:\n    def __init__(self, employee_id, name, manager_id=None):\n        self.employee_id = employee_id\n        self.name = name\n        self.manager_id = manager_id\n        self.subordinates = []\n        self.level = None\n        self.subordinate_count = 0\n        self.manager_chain = []\n\ndef build_org_chart(employees):\n    \"\"\"\n    Builds an organizational chart from a list of Employee objects.\n\n    Args:\n        employees: A list of Employee objects.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are Employee objects.\n    \"\"\"\n\n    employee_map = {emp.employee_id: emp for emp in employees}\n\n    # Build the subordinate relationships\n    for employee in employees:\n        if employee.manager_id:\n            manager = employee_map.get(employee.manager_id)\n            if manager:\n                manager.subordinates.append(employee)\n\n    return employee_map\n\ndef calculate_pecking_order(employee_map, ceo_id):\n    \"\"\"\n    Calculates the pecking order (level) for each employee.\n\n    Args:\n        employee_map: A dictionary of employee IDs to Employee objects.\n        ceo_id: The employee ID of the CEO.\n    \"\"\"\n\n    ceo = employee_map.get(ceo_id)\n    if not ceo:\n        raise ValueError(\"CEO not found.\")\n\n    ceo.level = 1\n    queue = [ceo]\n\n    while queue:\n        employee = queue.pop(0)\n        for subordinate in employee.subordinates:\n            subordinate.level = employee.level + 1\n            queue.append(subordinate)\n\ndef calculate_subordinate_count(employee_map):\n    \"\"\"\n    Calculates the total number of subordinates for each employee.\n\n    Args:\n        employee_map: A dictionary of employee IDs to Employee objects.\n    \"\"\"\n\n    def count_subordinates(employee):\n        count = 0\n        for subordinate in employee.subordinates:\n            count += 1 + count_subordinates(subordinate)\n        employee.subordinate_count = count\n        return count\n\n    for employee in employee_map.values():\n        if employee.level == 1: # Only start from the top level to avoid double counting\n            count_subordinates(employee)\n\ndef build_manager_chain(employee_map, ceo_id):\n    \"\"\"\n    Builds the manager chain for each employee.\n\n    Args:\n        employee_map: A dictionary of employee IDs to Employee objects.\n        ceo_id: The employee ID of the CEO.\n    \"\"\"\n\n    def build_chain(employee, chain):\n        if employee.manager_id:\n            manager = employee_map.get(employee.manager_id)\n            if manager:\n                new_chain = [manager.name] + chain\n                build_chain(manager, new_chain)\n        else:\n            employee.manager_chain = chain\n\n    for employee in employee_map.values():\n        if employee.employee_id != ceo_id:\n            build_chain(employee, [])\n\ndef resolve_organisational_pecking_order(employees, ceo_id):\n    \"\"\"\n    Resolves the organizational pecking order, subordinate count, and manager chain for each employee.\n\n    Args:\n        employees: A list of Employee objects.\n        ceo_id: The employee ID of the CEO.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are dictionaries containing:\n            - level: The employee's level in the organization.\n            - subordinate_count: The total number of subordinates.\n            - manager_chain: A list of manager names from the employee up to the CEO.\n    \"\"\"\n\n    employee_map = build_org_chart(employees)\n    calculate_pecking_order(employee_map, ceo_id)\n    calculate_subordinate_count(employee_map)\n    build_manager_chain(employee_map, ceo_id)\n\n    results = {}\n    for employee_id, employee in employee_map.items():\n        results[employee_id] = {\n            \"level\": employee.level,\n            \"subordinate_count\": employee.subordinate_count,\n            \"manager_chain\": employee.manager_chain\n        }\n\n    return results\n\nif __name__ == '__main__':\n    # Example Usage\n    employees = [\n        Employee(1, \"Alice\", None),  # CEO\n        Employee(2, \"Bob\", 1),\n        Employee(3, \"Charlie\", 1),\n        Employee(4, \"David\", 2),\n        Employee(5, \"Eve\", 2),\n        Employee(6, \"Frank\", 3),\n        Employee(7, \"Grace\", 4)\n    ]\n\n    ceo_id = 1\n    results = resolve_organisational_pecking_order(employees, ceo_id)\n\n    for employee_id, data in results.items():\n        employee_name = next(emp.name for emp in employees if emp.employee_id == employee_id)\n        print(f\"Employee: {employee_name} (ID: {employee_id})\")\n        print(f\"  Level: {data['level']}\")\n        print(f\"  Subordinate Count: {data['subordinate_count']}\")\n        print(f\"  Manager Chain: {data['manager_chain']}\")\n        print(\"-\" * 20)"
        ],
        "0.8": [
          "class Employee:\n    def __init__(self, employee_id, name, manager_id=None):\n        self.employee_id = employee_id\n        self.name = name\n        self.manager_id = manager_id\n        self.subordinates = []\n\ndef build_org_chart(employees):\n    \"\"\"\n    Builds an organizational chart from a list of employees.\n\n    Args:\n        employees: A list of Employee objects.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are Employee objects.\n    \"\"\"\n    org_chart = {}\n    for employee in employees:\n        org_chart[employee.employee_id] = employee\n\n    for employee in employees:\n        if employee.manager_id:\n            org_chart[employee.manager_id].subordinates.append(employee)\n\n    return org_chart\n\ndef calculate_pecking_order(org_chart, ceo_id):\n    \"\"\"\n    Calculates the pecking order (level) for each employee.\n\n    Args:\n        org_chart: A dictionary representing the organizational chart.\n        ceo_id: The employee ID of the CEO.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are their level in the organization.\n    \"\"\"\n    pecking_order = {}\n    queue = [(org_chart[ceo_id], 1)]  # Start with CEO at level 1\n\n    while queue:\n        employee, level = queue.pop(0)\n        pecking_order[employee.employee_id] = level\n        for subordinate in employee.subordinates:\n            queue.append((subordinate, level + 1))\n\n    return pecking_order\n\ndef calculate_subordinate_count(org_chart):\n    \"\"\"\n    Calculates the total number of subordinates for each employee.\n\n    Args:\n        org_chart: A dictionary representing the organizational chart.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are the number of subordinates.\n    \"\"\"\n    subordinate_count = {}\n\n    def count_subordinates(employee_id):\n        if employee_id in subordinate_count:\n            return subordinate_count[employee_id]\n\n        count = 0\n        employee = org_chart[employee_id]\n        for subordinate in employee.subordinates:\n            count += 1 + count_subordinates(subordinate.employee_id)\n\n        subordinate_count[employee_id] = count\n        return count\n\n    for employee_id in org_chart:\n        count_subordinates(employee_id)\n\n    return subordinate_count\n\ndef build_manager_chain(org_chart, employee_id, ceo_id):\n    \"\"\"\n    Builds the chain of managers for an employee up to the CEO.\n\n    Args:\n        org_chart: A dictionary representing the organizational chart.\n        employee_id: The employee ID for whom to build the chain.\n        ceo_id: The employee ID of the CEO.\n\n    Returns:\n        A list of manager names, starting from the employee's direct manager up to the CEO.\n    \"\"\"\n    manager_chain = []\n    employee = org_chart[employee_id]\n    manager_id = employee.manager_id\n\n    while manager_id:\n        manager = org_chart[manager_id]\n        manager_chain.append(manager.name)\n        if manager_id == ceo_id:\n            break\n        manager_id = manager.manager_id\n\n    return manager_chain\n\ndef analyze_organization(employees, ceo_id):\n    \"\"\"\n    Analyzes the organizational pecking order and resolves the chase.\n\n    Args:\n        employees: A list of Employee objects.\n        ceo_id: The employee ID of the CEO.\n\n    Returns:\n        A tuple containing:\n            - pecking_order: A dictionary of employee IDs to their level in the organization.\n            - subordinate_count: A dictionary of employee IDs to their subordinate count.\n            - manager_chains: A dictionary of employee IDs to their manager chain.\n    \"\"\"\n    org_chart = build_org_chart(employees)\n    pecking_order = calculate_pecking_order(org_chart, ceo_id)\n    subordinate_count = calculate_subordinate_count(org_chart)\n    manager_chains = {}\n    for employee_id in org_chart:\n        manager_chains[employee_id] = build_manager_chain(org_chart, employee_id, ceo_id)\n\n    return pecking_order, subordinate_count, manager_chains\n\nif __name__ == '__main__':\n    # Example Usage\n    employees = [\n        Employee(1, \"Alice\", None),  # CEO\n        Employee(2, \"Bob\", 1),\n        Employee(3, \"Charlie\", 1),\n        Employee(4, \"David\", 2),\n        Employee(5, \"Eve\", 2),\n        Employee(6, \"Frank\", 3),\n        Employee(7, \"Grace\", 3),\n        Employee(8, \"Heidi\", 4),\n    ]\n\n    ceo_id = 1\n    pecking_order, subordinate_count, manager_chains = analyze_organization(employees, ceo_id)\n\n    print(\"Pecking Order:\", pecking_order)\n    print(\"Subordinate Count:\", subordinate_count)\n    print(\"Manager Chains:\", manager_chains)"
        ],
        "0.9": [
          "def analyze_org_structure(org_chart):\n    \"\"\"\n    Analyzes the organizational power structure and resolves the pursual:\n\n    i. Pecking Order Degree: For each employee, determine their floor in the formation.\n       The chief operating officer be at stage one, verbatim news report to the chief operating officer constitute at stratum ii, and therefore on.\n    ii. Foot soldier Reckoning: For each employee, calculate the full turn of subsidiary nether them, let in collateral foot soldier.\n    iii. Managing director Concatenation: For each employee, number their chain of mountains of coach upwardly to the chief executive officer.\n\n    Args:\n        org_chart (dict): A dictionary representing the organization chart.\n                           Keys are employee names, and values are the name of their direct manager.\n                           The CEO's manager should be None.\n\n    Returns:\n        tuple: A tuple containing three dictionaries:\n            - pecking_order: A dictionary where keys are employee names and values are their pecking order degree.\n            - subordinate_count: A dictionary where keys are employee names and values are the number of their subordinates.\n            - manager_chain: A dictionary where keys are employee names and values are a list representing their chain of managers up to the CEO.\n    \"\"\"\n\n    pecking_order = {}\n    subordinate_count = {}\n    manager_chain = {}\n\n    def calculate_pecking_order(employee, level=1):\n        \"\"\"Calculates the pecking order degree for an employee.\"\"\"\n        pecking_order[employee] = level\n        for subordinate, manager in org_chart.items():\n            if manager == employee:\n                calculate_pecking_order(subordinate, level + 1)\n\n    def calculate_subordinate_count(employee):\n        \"\"\"Calculates the total number of subordinates for an employee.\"\"\"\n        count = 0\n        for subordinate, manager in org_chart.items():\n            if manager == employee:\n                count += 1 + calculate_subordinate_count(subordinate)\n        subordinate_count[employee] = count\n        return count\n\n    def calculate_manager_chain(employee):\n        \"\"\"Calculates the chain of managers up to the CEO for an employee.\"\"\"\n        chain = []\n        manager = org_chart.get(employee)\n        while manager:\n            chain.append(manager)\n            manager = org_chart.get(manager)\n        manager_chain[employee] = chain\n\n    # Find the CEO (the employee with no manager)\n    ceo = None\n    for employee, manager in org_chart.items():\n        if manager is None:\n            ceo = employee\n            break\n\n    if ceo is None:\n        raise ValueError(\"No CEO found in the organization chart.\")\n\n    # Calculate pecking order for all employees\n    calculate_pecking_order(ceo)\n\n    # Calculate subordinate count for all employees\n    for employee in org_chart.keys():\n        calculate_subordinate_count(employee)\n\n    # Calculate manager chain for all employees\n    for employee in org_chart.keys():\n        calculate_manager_chain(employee)\n\n    return pecking_order, subordinate_count, manager_chain\n\n\nif __name__ == '__main__':\n    # Example Usage\n    org_chart = {\n        \"Alice\": \"Bob\",\n        \"Bob\": \"Charlie\",\n        \"Charlie\": None,  # Charlie is the CEO\n        \"David\": \"Alice\",\n        \"Eve\": \"Bob\",\n        \"Frank\": \"David\",\n        \"Grace\": \"Eve\"\n    }\n\n    pecking_order, subordinate_count, manager_chain = analyze_org_structure(org_chart)\n\n    print(\"Pecking Order:\", pecking_order)\n    print(\"Subordinate Count:\", subordinate_count)\n    print(\"Manager Chain:\", manager_chain)"
        ],
        "1.0": [
          "class Employee:\n    def __init__(self, employee_id, name, manager_id=None):\n        self.employee_id = employee_id\n        self.name = name\n        self.manager_id = manager_id\n        self.level = None\n        self.subordinates_count = 0\n        self.manager_chain = []\n\ndef analyze_organization(employees):\n    \"\"\"\n    Analyzes the organizational power structure.\n\n    Args:\n        employees: A list of Employee objects.\n\n    Returns:\n        A dictionary where keys are employee IDs and values are dictionaries\n        containing the power structure analysis results: level,\n        subordinates_count, and manager_chain.\n    \"\"\"\n\n    employee_map = {emp.employee_id: emp for emp in employees}\n    ceo = next((emp for emp in employees if emp.manager_id is None), None)\n\n    if not ceo:\n        return {}  # Empty organization\n\n    ceo.level = 1\n    results = {}\n\n    def calculate_level(employee):\n        if employee.manager_id:\n            manager = employee_map.get(employee.manager_id)\n            if manager and manager.level is None:\n                calculate_level(manager)\n            employee.level = manager.level + 1\n        else:\n            employee.level = 1\n\n    def calculate_subordinates_count(employee):\n        count = 0\n        for subordinate in employee_map.values():\n            if subordinate.manager_id == employee.employee_id:\n                count += 1 + calculate_subordinates_count(subordinate)\n        employee.subordinates_count = count\n        return count\n\n    def calculate_manager_chain(employee):\n        chain = []\n        current = employee\n        while current.manager_id:\n            manager = employee_map.get(current.manager_id)\n            if manager:\n                chain.insert(0, manager.employee_id)\n                current = manager\n            else:\n                break\n        employee.manager_chain = chain\n\n    # Calculate levels\n    for employee in employee_map.values():\n        if employee.level is None:\n            calculate_level(employee)\n\n    # Calculate subordinates count\n    for employee in employee_map.values():\n        calculate_subordinates_count(employee)\n\n    # Calculate manager chain\n    for employee in employee_map.values():\n        calculate_manager_chain(employee)\n\n    for employee in employee_map.values():\n        results[employee.employee_id] = {\n            \"level\": employee.level,\n            \"subordinates_count\": employee.subordinates_count,\n            \"manager_chain\": employee.manager_chain,\n        }\n\n    return results\n\nif __name__ == '__main__':\n    # Example Usage\n    employees = [\n        Employee(1, \"Alice\", None),\n        Employee(2, \"Bob\", 1),\n        Employee(3, \"Charlie\", 1),\n        Employee(4, \"David\", 2),\n        Employee(5, \"Eve\", 2),\n        Employee(6, \"Frank\", 3),\n        Employee(7, \"Grace\", 4),\n    ]\n\n    analysis_results = analyze_organization(employees)\n\n    for employee_id, data in analysis_results.items():\n        print(f\"Employee ID: {employee_id}\")\n        print(f\"  Level: {data['level']}\")\n        print(f\"  Subordinates Count: {data['subordinates_count']}\")\n        print(f\"  Manager Chain: {data['manager_chain']}\")\n        print(\"-\" * 20)"
        ]
      }
    }
  }
}